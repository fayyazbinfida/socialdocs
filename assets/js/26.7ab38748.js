(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{1509:function(e,t,o){"use strict";o.r(t);var s=o(31),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"inbound-webhooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inbound-webhooks"}},[e._v("#")]),e._v(" Inbound Webhooks")]),e._v(" "),s("p",[e._v("Inbound webhook is a powerful tool to receive data from anywhere to the chatbot through a POST request.")]),e._v(" "),s("p",[e._v("With inbound webhooks, your bot can even start a conversation with a bot user who never talked to it before.")]),e._v(" "),s("p",[e._v("For example, when a client fills in their contact information on your website, you send the data to an inbound webhook of a chatbot, say an SMS bot. The SMS bot can then send a confirmation message to the client's phone number.")]),e._v(" "),s("p",[e._v("If that webhook is built in a Voice bot, the bot can even call the client right away!")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("Limitation")]),e._v(" "),s("p",[e._v("Each bot has up to 5 inbound webhooks.")])]),e._v(" "),s("h2",{attrs:{id:"create-inbound-webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-inbound-webhook"}},[e._v("#")]),e._v(" Create Inbound Webhook")]),e._v(" "),s("p",[e._v("It's available in almost all channels, in your flow builder, go "),s("strong",[e._v("Tools")]),e._v(" - "),s("strong",[e._v("Inbound Webhooks")]),e._v(":")]),e._v(" "),s("p",[s("img",{attrs:{src:o(813),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Click on "),s("strong",[e._v("New Inbound Webhook")]),e._v(", give a name and click "),s("strong",[e._v("Save")]),e._v(":")]),e._v(" "),s("p",[s("img",{attrs:{src:o(814),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("You will see the editing interface like this:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(815),alt:"inbound webhook"}})]),e._v(" "),s("h3",{attrs:{id:"webhook-address"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webhook-address"}},[e._v("#")]),e._v(" Webhook Address")]),e._v(" "),s("p",[e._v("This area shows you where to send the data and the method, which is POST. Each inbound webhook has a unique URL in the whole UChat system.")]),e._v(" "),s("h3",{attrs:{id:"example-of-received-json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-of-received-json"}},[e._v("#")]),e._v(" Example of Received JSON")]),e._v(" "),s("p",[e._v("This area shows an example JSON for reference. It describes the structure of the data in the JSON we received later. We need it to find the values for both **user identification ** and "),s("strong",[e._v("data to save")]),e._v(".")]),e._v(" "),s("p",[e._v("There are 2 ways to get an example JSON:")]),e._v(" "),s("ol",[s("li",[e._v("manually type/paste it here")]),e._v(" "),s("li",[e._v("listen to a real-time data from a live test")])]),e._v(" "),s("h3",{attrs:{id:"values-to-identify-a-user"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#values-to-identify-a-user"}},[e._v("#")]),e._v(" Values to Identify a User")]),e._v(" "),s("p",[e._v("Whenever the webhook receives data, it first checks the paths you specify here to see whether it can find an existing user in the chatbot.")]),e._v(" "),s("p",[e._v("If the user is not in the system, the chatbot will create a new profile. That's how the chatbot initiates a conversation without talking to the user before.")]),e._v(" "),s("p",[e._v("However, some channels don't allow the chatbot to start the conversation first due to privacy and spam issues.")]),e._v(" "),s("p",[e._v("For example, your SMS bot can send messages as long as you have the recipient's phone number, while your Facebook Messenger chatbot cannot send messages to a Facebook user who never talked to your bot before.")]),e._v(" "),s("h4",{attrs:{id:"process-for-user-identification"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#process-for-user-identification"}},[e._v("#")]),e._v(" Process for User Identification")]),e._v(" "),s("p",[e._v("This is the process of how the system identifies a user:")]),e._v(" "),s("ol",[s("li",[e._v("check "),s("code",[e._v("user_ns")]),e._v(" "),s("ul",[s("li",[e._v("if there is a valid "),s("code",[e._v("user_ns")]),e._v(", user found.")]),e._v(" "),s("li",[e._v("if not, next step")])])]),e._v(" "),s("li",[e._v("check "),s("code",[e._v("phone")]),e._v(" / "),s("code",[e._v("email")]),e._v(" "),s("ul",[s("li",[e._v("if we can find a user by the "),s("code",[e._v("phone")]),e._v(" or "),s("code",[e._v("email")]),e._v(", user found.")]),e._v(" "),s("li",[e._v("if not, next step")])])]),e._v(" "),s("li",[e._v("verify "),s("code",[e._v("phone")]),e._v(" "),s("ul",[s("li",[e._v("no user matched in the system, is the "),s("code",[e._v("phone")]),e._v(" a valid number?")]),e._v(" "),s("li",[e._v("if yes, user profile created.")]),e._v(" "),s("li",[e._v("if not, webhook won't be processed")])])])]),e._v(" "),s("h3",{attrs:{id:"mapping-area"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mapping-area"}},[e._v("#")]),e._v(" Mapping Area")]),e._v(" "),s("p",[e._v("The mapping list shows which value should be stored in which custom field. When you get a sample JSON in the above area, click on "),s("strong",[e._v("Preview Payload")]),e._v(" to get a mapping tool.")]),e._v(" "),s("h2",{attrs:{id:"webhook-logs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webhook-logs"}},[e._v("#")]),e._v(" Webhook Logs")]),e._v(" "),s("p",[s("img",{attrs:{src:o(816),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Every single request is saved in "),s("strong",[e._v("Logs")]),e._v(". Click on a record to see the received JSON data.")]),e._v(" "),s("h2",{attrs:{id:"demo-booking-confirmation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#demo-booking-confirmation"}},[e._v("#")]),e._v(" Demo: Booking Confirmation")]),e._v(" "),s("p",[e._v("A perfect tool to test your inbound webhook is already built-in everywhere! Simple get a chatbot (whatever channel), test it in an "),s("strong",[e._v("Action Step")]),e._v(".")]),e._v(" "),s("p",[e._v("Open another UChat webpage side by side, keep the inbound webhook editing on Page 1 and select an external request on Page 2:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(817),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Follow steps 1 to 8 in the following screenshot:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(818),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Provide the data that need to be sent to the chatbot and click "),s("strong",[e._v("Test")]),e._v(", you must get a \"webhook inactive\" error since we haven't activated it yet. It's fine, click on "),s("strong",[e._v("Done")]),e._v(" on Page 1, and you will see the data saved:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(819),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Scroll down a bit, follow steps 1, 2, 3 to tell the system, where is the "),s("code",[e._v("phone")]),e._v(" and "),s("code",[e._v("email")]),e._v(" values in the JSON:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(820),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Finally, map the rest data to the chatbot:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(821),alt:"inbound webhook"}})]),e._v(" "),s("p",[s("strong",[e._v("Save")]),e._v(" your inbound webhook editing:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(822),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("Enter the subflow, let's send a message to the bot user:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(823),alt:"inbound webhook"}})]),e._v(" "),s("p",[s("strong",[e._v("Publish")]),e._v(" the flow and let's do a live test in the external request again:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(824),alt:"inbound webhook"}})]),e._v(" "),s("p",[e._v("We can see that this time it run without error because we activated the webhook and used a real phone number. Go to "),s("strong",[e._v("Logs")]),e._v(" and we can see a new user profile is created successfully.")]),e._v(" "),s("p",[e._v("On the user side:")]),e._v(" "),s("p",[s("img",{attrs:{src:o(825),alt:"inbound webhook"}})])])}),[],!1,null,null,null);t.default=a.exports},813:function(e,t,o){e.exports=o.p+"assets/img/inbound1.260c5353.png"},814:function(e,t,o){e.exports=o.p+"assets/img/inbound2.6b5f861c.png"},815:function(e,t,o){e.exports=o.p+"assets/img/inbound3.91d71327.png"},816:function(e,t,o){e.exports=o.p+"assets/img/inbound10.32ebdea8.png"},817:function(e,t,o){e.exports=o.p+"assets/img/inbound4.3540edf1.png"},818:function(e,t,o){e.exports=o.p+"assets/img/inbound5.1e473657.png"},819:function(e,t,o){e.exports=o.p+"assets/img/inbound6.24b11030.png"},820:function(e,t,o){e.exports=o.p+"assets/img/inbound7.0be10acc.png"},821:function(e,t,o){e.exports=o.p+"assets/img/inbound8.c015694b.png"},822:function(e,t,o){e.exports=o.p+"assets/img/inbound9.982059f7.png"},823:function(e,t,o){e.exports=o.p+"assets/img/inbound11.dfa11cae.png"},824:function(e,t,o){e.exports=o.p+"assets/img/inbound12.1b3a13dc.png"},825:function(e,t,o){e.exports=o.p+"assets/img/inbound13.7fb0f9b4.png"}}]);